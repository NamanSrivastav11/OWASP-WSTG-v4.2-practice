# WSTG-CONF-04 - Review Old, Backup and Unreferenced Files for Sensitive Information

## Category

Configuration and Deployment 

## Summary

Old, backup, and unreferenced files present critical security threats to web applications. These files may contain sensitive information that can facilitate attacks, expose source code with vulnerabilities, or provide access to hidden functionality not linked from published content.

Common scenarios include:

- Renamed old versions of modified files (e.g., `login.asp.old`)
- Inclusion files that can be downloaded as source code
- Automatic or manual backup archives (e.g., `.zip`, `.tar.gz`)
- Editor backup files (e.g., `file~`)
- Configuration files left in web-accessible directories

Developers may inadvertently leave backup copies when editing files on production servers or creating backup archives that are never removed from the web root.


## Test Objective

- Find and analyze unreferenced files that might contain sensitive information
- Identify old and backup files that expose source codee or credentials
- Discover files generated by editors or backup mechanisms
- Identify files accessible through non-standard naming patterns
- Determine impact of Information disclosure from old files


## Reference

[OWASP WSTG-CONF-04: Review Old Backup and Unreferenced Files for Sensitive Information](https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/04-Review_Old_Backup_and_Unreferenced_Files_for_Sensitive_Information)

-----------


## Test Environment

**Target Application:** `testphp.vulnweb.com`

**Authentication:** Not required

**Tools Used:**

- curl (HTTP requests)
- OWASP ZAP (spider and scanner)

-----------


## Background

Sensitive data exposure frequently occurs when old or unreferenced files remain deployed after updates. Typical examples include:

- Old versions of pages/scripts (`index_old`, `login.bak`)
- Backup archives (`.zip`, `.tar`, `.gz`, `.7z`, `.rar`)
- Editor/temporary files (`~`, `.swp`, `.tmp`)
- Config/log/data exports (`.conf`, `.ini`, `.log`, `.sql`, `.csv`)
- Deprecated endpoints no longer linked from  the current UI

These files are often not part of normal navigation, so explicit discovery and direct access testing are required.


------------


## Test Methodology

1. Build a list of candidate file and directory names from current application mapping
2. Test naming patterns commonly used for old/backup/unreferenced artifacts
3. Verify whether discovered artifacts are accessible and contain sensitive information


----------


## Validation Steps

### Step 1 - Map the Application to build a list

Use OWASP ZAP Spider and Sites Tree to enumerate endpoints and file names. Extract high-value base names (for example: `login`, `index`, `admin`, `transfer`, `config`, `account`, etc.)

We can also capture discovered directories to test for older copies
